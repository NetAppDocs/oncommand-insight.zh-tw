---
sidebar: sidebar 
permalink: task_config_telegraf_apache.html 
keywords: telegraf, installation, install, apache 
summary: Apache資料收集器組態 
---
= Apache Data Collector
:hardbreaks:
:toclevels: 1
:allow-uri-read: 
:toclevels: 1
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
此資料收集器可從您環境中的Apache伺服器收集資料。

.先決條件
* 您必須設定Apache HTTP伺服器並正確執行
* 您必須擁有代理主機/ VM的Sudo或系統管理員權限
* 通常、Apache _mod_STATUS_模組會設定為在Apache伺服器的「/server-STATUS」自動位置公開頁面。必須啟用「_ExtendedStatus」選項、才能收集所有可用欄位。如需如何設定伺服器的相關資訊、請參閱Apache模組文件： https://httpd.apache.org/docs/2.4/mod/mod_status.html#enable[]




== 安裝

. 從 * 可伺服 > 收集器 * 、按一下 * + 資料收集器 * 。選擇 Apache 。
+
選取安裝Telegraf代理程式的作業系統或平台。

. 如果您尚未安裝代理程式以供收集、或想要為不同的作業系統或平台安裝代理程式、請按一下「_顯示指示_」以展開 link:task_config_telegraf_agent.html["代理程式安裝"] 說明。
. 選取要搭配此資料收集器使用的代理程式存取金鑰。您可以按一下「*+代理程式存取金鑰*」按鈕來新增代理存取金鑰。最佳實務做法：只有當您想要將資料收集器分組時、才使用不同的代理程式存取金鑰、例如依作業系統/平台。
. 請依照組態步驟設定資料收集器。這些指示會因您用來收集資料的作業系統或平台類型而有所不同。


image:ApacheDCConfigLinux.png["Apache組態"]



== 設定

Telegraf的Apache HTTP伺服器外掛程式仰賴要啟用的「mod_STATUS」模組。啟用此功能時、Apache的HTTP伺服器會公開一個HTML端點、您可以在瀏覽器上檢視、或擷取所有Apache HTTP伺服器組態的狀態。



=== 相容性：

組態是根據Apache的HTTP伺服器2.4.38版而開發。



=== 啟用mod_STATUS：

啟用和展示「mod_STATUS」模組需要兩個步驟：

* 啟用模組
* 展示單元的統計資料




=== 啟用模組：

模組的載入是由「/usr/local/apache/conf/httpd.conf」下的組態檔所控制。編輯組態檔並取消註釋下列行：

 LoadModule status_module modules/mod_status.so
 Include conf/extra/httpd-info.conf


=== 展示單元的統計資料：

「mod_STATUS」的曝光是由「usr/local/ap2/conf/Extra / httpd-info.conf」下的組態檔所控制。請確定該組態檔中有下列項目（至少會有其他指令）：

[listing]
----
# Allow server status reports generated by mod_status,
# with the URL of http://servername/server-status
<Location /server-status>
    SetHandler server-status
</Location>

#
# ExtendedStatus controls whether Apache will generate "full" status
# information (ExtendedStatus On) or just basic information (ExtendedStatus
# Off) when the "server-status" handler is called. The default is Off.
#
ExtendedStatus On
----
如需「mod_STATUS」模組的詳細說明、請參閱 link:https://httpd.apache.org/docs/2.4/mod/mod_status.html#enable["Apache文件"]



== 物件與計數器

收集下列物件及其計數器：

[cols="<.<,<.<,<.<,<.<"]
|===
| 物件： | 識別碼： | 屬性： | 資料點： 


| Apache | 命名空間
伺服器 | 節點 IP
節點名稱
連接埠
父伺服器組態產生
父伺服器 MPM 世代
伺服器正常運作時間
正在停止 | 忙碌的員工
每個要求的位元組數
每秒位元組數
CPU 子系系統
CPU 子使用者
CPU 負載
CPU 系統
CPU 使用者
非同步連線關閉
非同步連線保持活動狀態
非同步連線寫入
連線總數
每個要求的持續時間
閒置的員工
平均負載（最後 1 公尺）
平均負載（前 15 分鐘）
平均負載（最後 5 分鐘）
流程
每秒要求數
總存取量
總持續時間
總 KB 數
記分板關閉
記分板 DNS 查詢
記分板完成
記分板閒置清除
記分板保持活動狀態
記分板記錄
記分板開啟
記分板讀取
記分板傳送中
記分板開始
記分板等待中 
|===


== 疑難排解

如需其他資訊、請參閱 link:concept_requesting_support.html["支援"] 頁面。
