---
sidebar: sidebar 
permalink: task_config_telegraf_kafka.html 
keywords: telegraf, installation, install, kafka 
summary: Kafka資料收集器組態 
---
= Kafka資料收集器
:hardbreaks:
:toclevels: 1
:allow-uri-read: 
:toclevels: 1
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
此資料收集器可用來收集卡夫卡的數據。Cloud Insights



== 安裝

. 從 * 可伺服 > 收集器 * 、按一下 * + 資料收集器 * 。選擇 Kafka 。
+
選取安裝Telegraf代理程式的作業系統或平台。

. 如果您尚未安裝代理程式以供收集、或想要為不同的作業系統或平台安裝代理程式、請按一下「_顯示指示_」以展開 link:task_config_telegraf_agent.html["代理程式安裝"] 說明。
. 選取要搭配此資料收集器使用的代理程式存取金鑰。您可以按一下「*+代理程式存取金鑰*」按鈕來新增代理存取金鑰。最佳實務做法：只有當您想要將資料收集器分組時、才使用不同的代理程式存取金鑰、例如依作業系統/平台。
. 請依照組態步驟設定資料收集器。這些指示會因您用來收集資料的作業系統或平台類型而有所不同。


image:KafkaDCConfigWindows.png["Kafka組態"]



== 設定

Kafka外掛程式是以Telewraf的Jolokia外掛程式為基礎。例如、需要從所有的Kafka代理商收集資訊、需要透過Jolkia設定和公開所有元件的JMX。



=== 相容性

組態是針對Kafka 0.11.0.2版所開發。



=== 設定

以下所有指示均假設您的Kafka安裝位置為「/opt/Kafka」。您可以調整下列指示、以反映您的安裝位置。



==== Jolokia代理程式Jar

Jokia代理程式Jar檔案的版本必須是 link:https://jolokia.org/download.html["已下載"]。測試的版本是Joslokia代理1.6.0.

以下說明假設下載的Jar檔案（jolokia -jvm-1.6.0-agent.jar）位於「/opt / Kafka/libs/」的位置。



==== 卡夫卡經紀人

若要設定Kafka代理商以公開Jolokia API、您可以在「Kafka-rer-class.sh」通話之前、在<Kafka_hom>/bin/Kafka-server-start.sh中新增下列項目：

[listing]
----
export JMX_PORT=9999
export RMI_HOSTNAME=`hostname -I`
export KAFKA_JMX_OPTS="-javaagent:/opt/kafka/libs/jolokia-jvm-1.6.0-agent.jar=port=8778,host=0.0.0.0  -Dcom.sun.management.jmxremote.password.file=/opt/kafka/config/jmxremote.password -Dcom.sun.management.jmxremote.ssl=false -Djava.rmi.server.hostname=$RMI_HOSTNAME -Dcom.sun.management.jmxremote.rmi.port=$JMX_PORT"
----
請注意、上述範例使用「主機名稱-I」來設定「RMI_HOSTNAME」環境變數。在多個IP機器中、需要調整此設定、才能收集您所關心的RMI連線IP。

您可以為JMx（上方9999）和Joslokia（8778）選擇不同的連接埠。如果您有內部IP來鎖定Jolokia、您可以用自己的IP來取代「全部抓出」0．0．0。請注意、此IP必須從遠端工作人員外掛程式存取。如果您不想驗證、可以使用「-Dcom.sun.management.jmxremote.authenticate=false'」選項。使用風險由您自行承擔。



== 物件與計數器

收集下列物件及其計數器：

[cols="<.<,<.<,<.<,<.<"]
|===
| 物件： | 識別碼： | 屬性： | 資料點： 


| 卡夫卡代理人 | 叢集
命名空間
代理程式 | 節點名稱
節點 IP | 複本管理程式 Fetcher Max Lag
Zookkeeper Client Connections
Zookeeper 用戶端連線（ 15 分鐘費率）
Zookkeeper 用戶端連線（ 5 分鐘費率）
Zookeper 用戶端連線（平均速率）
Zookeeper 用戶端連線（ 1 公尺速率）
複本管理程式分割計數
執行緒計數精靈
執行緒計數尖峰
執行緒計數目前
執行緒總數已開始
離線分割區
產生要求總時間（第 50 百分位數）
產生要求總時間（第 75 個百分位數）
產生要求總時間（第 95 個百分位數）
產生要求總時間（ 98 百分位數）
產品申請總時間（第 999 百分位數）
產生要求總時間（第 99 個百分位數）
產生要求總時間
產生要求總時間上限
產生要求總時間平均值
產生要求總時間最小值
產生要求總時間 stddev
Replication Manager ISR 收縮
Replication Manager ISR 收縮（ 15m 速率）
Replication Manager ISR 收縮（ 5 公尺速率）
Replication Manager ISR 收縮（平均速率）
Replication Manager ISR 收縮（ 1 公尺速率）
要求處理常式平均閒置
要求處理常式平均閒置（ 15 分鐘率）
要求處理常式平均閒置（ 5 分鐘速率）
要求處理常式平均閒置（平均速率）
要求處理常式平均閒置（ 1 公尺速率）
廢棄項目收集 G1 舊一代計數
廢棄項目收集 G1 舊一代時間
垃圾回收 G1 年輕一代計數
垃圾回收 G1 年輕世代時間
Zookeper 只讀連接
Zookkeeper 唯讀連線（ 15 分鐘費率）
Zookkeeper 唯讀連線（ 5 分鐘速率）
Zookeper 唯讀連線（平均速率）
Zookeper 只讀連接（ 1 公尺速率）
網路處理器平均閒置
申請 Fetch Follower 總時間（第 50 個百分位數）
要求擷取追蹤總時間（ 75 個百分位數）
申請 Fetch Follower 總時間（第 95 個百分位數）
要求擷取追蹤總時間（第 98 個百分位數）
申請 Fetch Follower 總時間（ 999 百分位數）
要求擷取追蹤總時間（第 99 個百分位數）
要求擷取追蹤總時間
要求擷取追蹤器總時間上限
要求擷取追蹤總時間平均值
申請擷取追蹤總時間最小值
要求擷取追蹤器總時間 stddev
等待產生通知的要求
網路要求擷取消費者
網路要求擷取消費者（ 5 分鐘速率）
網路要求擷取消費者（ 15 分鐘費率）
網路要求擷取消費者（平均速率）
網路要求擷取消費者（ 1 公尺速率）
不幹凈的領導人選舉
不乾淨的 Leader 選項（ 15 分鐘費率）
不乾淨的領導人選舉（ 5 分鐘率）
不乾淨的領導人選舉（平均率）
不潔的領導者選舉（ 1 公尺率）
主動式控制器
堆積記憶體已認可
堆積記憶體初始化
堆積記憶體上限
使用的堆積記憶體
Zookkeeper 工作階段已過期
Zookkeeper 工作階段已過期（ 15 分鐘費率）
Zookkeeper 工作階段過期（ 5 分鐘費率）
Zookkeeper 工作階段過期（平均速率）
Zookkeeper 工作階段過期（ 1 公尺費率）
Zookeper 驗證失敗
Zookeper 驗證失敗（ 15 分鐘率）
Zookeper 驗證失敗（ 5 分鐘率）
Zookeper 驗證失敗（平均速率）
Zookeper 驗證失敗（ 1 公尺率）
領導者選舉時間（第 50 百分位數）
領導者選舉時間（第 75 百分位數）
領導者選舉時間（第 95 個百分位數）
領導者選舉時間（第 98 個百分位數）
領導者選舉時間（第 999 百分位數）
領導者選舉時間（第 99 個百分位數）
Leader 選舉計數
Leader 選舉時間（ 15 分鐘費率）
Leader 選舉時間（ 5 分鐘率）
Leader 選擇時間上限
Leader 選舉時間代表
領導者選舉時間（平均速率）
Leader 選舉時間最短
領導者選舉時間（ 1 公尺速率）
領導者選舉時間（ stddev ）
網路要求 Fetch Follower
網路要求 Fetch Follower （ 15 分鐘速率）
網路要求 Fetch Follower （ 5 分鐘速率）
網路要求 Fetch Follower （平均速率）
網路要求 Fetch Follower （ 1 公尺速率）
代理人主題訊息
代理人主題訊息（ 15 分鐘費率）
代理人主題訊息（ 5 分鐘速率）
代理人主題訊息（平均速率）
代理人主題訊息（ 1 公尺速率）
代理主題位元組
代理主題位元組（ 15 分鐘速率）
代理主題位元組（ 5 分鐘速率）
代理主題位元組（平均速率）
代理主題位元組（ 1 公尺速率）
Zookeeper Disconns Count
Zookeeper 中斷連線（ 15 分鐘費率）
Zookeeper 中斷連線（ 5 分鐘費率）
Zookeeper 中斷連線（平均速率）
Zookeeper 中斷連線（ 1 公尺費率）
網路要求擷取使用者總時間（第 50 個百分位數）
網路要求擷取使用者總時間（ 75 百分位數）
網路要求擷取使用者總時間（ 95 百分位數）
網路要求擷取使用者總時間（第 98 個百分位數）
網路要求擷取使用者總時間（ 999 百分位數）
網路要求擷取使用者總時間（第 99 百分位數）
網路要求擷取使用者總時間
網路要求擷取取使用者總時間上限
網路要求擷取消費者總時間平均值
網路要求擷取使用者總時間最小值
網路要求擷取取取使用者總時間 stddev
LeaderCount
在 Fetch Purgatory 中等待的要求
代理主題位元組輸出
代理程式主題位元組輸出（ 15 分鐘速率）
代理程式主題位元組輸出（ 5 分鐘速率）
代理程式主題位元組輸出（平均速率）
Broker 主題位元組輸出（ 1 公尺速率）
Zookeper 驗證
Zookeper 驗證（ 15 分鐘率）
Zookkeeper 驗證（ 5 分鐘速率）
Zookeper 驗證（平均速率）
Zookeper 驗證（ 1 公尺速率）
要求產生計數
申請產品（ 15 分鐘費率）
申請產品（ 5 分鐘費率）
申請產品（平均費率）
申請產品（ 1 公尺費率）
複本管理器 ISR 將展開
複本管理器 ISR 擴充（ 15 分鐘費率）
複本管理器 ISR 擴充（ 5 分鐘速率）
複本管理器 ISR 擴充（平均速率）
複本管理器 ISR 擴充（ 1 公尺速率）
複本管理程式位於複寫分割下 
|===


== 疑難排解

如需其他資訊、請參閱 link:concept_requesting_support.html["支援"] 頁面。
