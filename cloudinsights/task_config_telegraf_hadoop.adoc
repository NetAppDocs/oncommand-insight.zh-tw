---
sidebar: sidebar 
permalink: task_config_telegraf_hadoop.html 
keywords: telegraf, installation, install, Hadoop 
summary: Hadoop資料收集器組態 
---
= Hadoop Data Collector
:hardbreaks:
:toclevels: 1
:allow-uri-read: 
:toclevels: 1
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
使用此資料收集器從Hadoop收集指標。Cloud Insights



== 安裝

. 從 * 可伺服 > 收集器 * 、按一下 * + 資料收集器 * 。選擇 Hadoop 。
+
選取安裝Telegraf代理程式的作業系統或平台。

. 如果您尚未安裝代理程式以供收集、或想要為不同的作業系統或平台安裝代理程式、請按一下「_顯示指示_」以展開 link:task_config_telegraf_agent.html["代理程式安裝"] 說明。
. 選取要搭配此資料收集器使用的代理程式存取金鑰。您可以按一下「*+代理程式存取金鑰*」按鈕來新增代理存取金鑰。最佳實務做法：只有當您想要將資料收集器分組時、才使用不同的代理程式存取金鑰、例如依作業系統/平台。
. 請依照組態步驟設定資料收集器。這些指示會因您用來收集資料的作業系統或平台類型而有所不同。


image:HadoopDCConfigLinux-1.png["Hadoop組態"]
image:HadoopDCConfigLinux-2.png["Hadoop組態"]



== 設定

完整的Hadoop部署包含下列元件：

* NameNode：Hadoop分散式檔案系統（HDFS）主要系統。協調一系列DataNode。
* 次要NameNode：主NameNode的暖容錯移轉。在Hadoop中、不會自動升級至NameNode。次要NameNode會從NameNode收集資訊、以便在需要時隨時升級。
* DataNode：資料的實際擁有者。
* 資源管理器：運算主系統（Yarn）。協調一系列的NodeManager。
* NodeManager：運算資源。執行應用程式的實際位置。
* JobhistoryServer：負責服務所有工作歷程記錄相關要求。


Hadoop外掛程式是以Telewraf的Jolokia外掛程式為基礎。例如、需要從所有Hadoop元件收集資訊、需要在所有元件上透過Jolokia設定和公開的JMX。



=== 相容性

組態是根據Hadoop 2.2.9版開發而成。



=== 設定



==== Jolokia代理程式Jar

對於所有個別元件、必須下載Jolokia代理程式Jar檔案的版本。測試版本為 link:https://jolokia.org/download.html["約洛基亞代理商1.6.0"]。

以下說明假設下載的Jar檔案（jolokia -jvm-1.6.0-agent.jar）位於「/op/Hadoop /lib/」位置。



==== NameNode

若要設定NameNode以公開Jolokia API、您可以在<Hadoop主頁>/etc/Hadoop / Hadoop -env.sh中設定下列項目：

[listing]
----
export HADOOP_NAMENODE_OPTS="$HADOOP_NAMENODE_OPTS -javaagent:/opt/hadoop/lib/jolokia-jvm-1.6.0-agent.jar=port=7800,host=0.0.0.0 -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.port=8000 -Dcom.sun.management.jmxremote.ssl=false -Dcom.sun.management.jmxremote.password.file=$HADOOP_HOME/conf/jmxremote.password"
You can choose a different port for JMX (8000 above) and Jolokia (7800). If you have an internal IP to lock Jolokia onto you can replace the "catch all" 0.0.0.0 by your own IP. Notice this IP needs to be accessible from the telegraf plugin. You can use the option '-Dcom.sun.management.jmxremote.authenticate=false' if you don't want to authenticate. Use at your own risk.
----


==== 次要NameNode

若要將次要NameNode設定為公開Jolokia API、您可以在<Hadoop主目錄>/etc/Hadoop / Hadoop -env.sh中設定下列項目：

[listing]
----
export HADOOP_SECONDARYNAMENODE_OPTS="$HADOOP_SECONDARYNAMENODE_OPTS -javaagent:/opt/hadoop/lib/jolokia-jvm-1.6.0-agent.jar=port=7802,host=0.0.0.0 -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.port=8002 -Dcom.sun.management.jmxremote.ssl=false -Dcom.sun.management.jmxremote.password.file=$HADOOP_HOME/conf/jmxremote.password"
You can choose a different port for JMX (8002 above) and Jolokia (7802). If you have an internal IP to lock Jolokia onto you can replace the "catch all" 0.0.0.0 by your own IP. Notice this IP needs to be accessible from the telegraf plugin. You can use the option '-Dcom.sun.management.jmxremote.authenticate=false' if you don't want to authenticate. Use at your own risk.
----


==== DataNode

若要將DataNode設定為公開Jolokia API、您可以在<Hadoop主頁>/etc/Hadoop / Hadoop -env.sh中設定下列項目：

[listing]
----
export HADOOP_DATANODE_OPTS="$HADOOP_DATANODE_OPTS -javaagent:/opt/hadoop/lib/jolokia-jvm-1.6.0-agent.jar=port=7801,host=0.0.0.0 -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.port=8001 -Dcom.sun.management.jmxremote.ssl=false -Dcom.sun.management.jmxremote.password.file=$HADOOP_HOME/conf/jmxremote.password"
You can choose a different port for JMX (8001 above) and Jolokia (7801). If you have an internal IP to lock Jolokia onto you can replace the "catch all" 0.0.0.0 by your own IP. Notice this IP needs to be accessible from the telegraf plugin. You can use the option '-Dcom.sun.management.jmxremote.authenticate=false' if you don't want to authenticate. Use at your own risk.
----


==== 資源管理程式

若要設定資源管理程式以公開Jolokia API、您可以在<Hadoop主頁>/etc/Hadoop / Hadoop -env.sh中設定下列項目：

[listing]
----
export YARN_RESOURCEMANAGER_OPTS="$YARN_RESOURCEMANAGER_OPTS -javaagent:/opt/hadoop/lib/jolokia-jvm-1.6.0-agent.jar=port=7803,host=0.0.0.0 -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.port=8003 -Dcom.sun.management.jmxremote.ssl=false -Dcom.sun.management.jmxremote.password.file=$HADOOP_HOME/conf/jmxremote.password"
You can choose a different port for JMX (8003 above) and Jolokia (7803). If you have an internal IP to lock Jolokia onto you can replace the "catch all" 0.0.0.0 by your own IP. Notice this IP needs to be accessible from the telegraf plugin. You can use the option '-Dcom.sun.management.jmxremote.authenticate=false' if you don't want to authenticate. Use at your own risk.
----


==== NodeManager

若要設定NodeManager以公開Jolokia API、您可以在<Hadoop主頁>/etc/Hadoop / Hadoop -env.sh中設定下列項目：

[listing]
----
export YARN_NODEMANAGER_OPTS="$YARN_NODEMANAGER_OPTS -javaagent:/opt/hadoop/lib/jolokia-jvm-1.6.0-agent.jar=port=7804,host=0.0.0.0 -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.port=8004 -Dcom.sun.management.jmxremote.ssl=false -Dcom.sun.management.jmxremote.password.file=$HADOOP_HOME/conf/jmxremote.password"
You can choose a different port for JMX (8004 above) and Jolokia (7804). If you have an internal IP to lock Jolokia onto you can replace the "catch all" 0.0.0.0 by your own IP. Notice this IP needs to be accessible from the telegraf plugin. You can use the option '-Dcom.sun.management.jmxremote.authenticate=false' if you don't want to authenticate. Use at your own risk.
----


==== 作業歷史伺服器

若要將JobHistoryServer設定為公開Jolokia API、您可以在<Hadoop主頁>/etc/Hadoop / Hadoop -env.sh中設定下列項目：

[listing]
----
export HADOOP_JOB_HISTORYSERVER_OPTS="$HADOOP_JOB_HISTORYSERVER_OPTS -javaagent:/opt/hadoop/lib/jolokia-jvm-1.6.0-agent.jar=port=7805,host=0.0.0.0 -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.port=8005 -Dcom.sun.management.jmxremote.password.file=$HADOOP_HOME/conf/jmxremote.password"
You can choose a different port for JMX (8005 above) and Jolokia (7805). If you have an internal IP to lock Jolokia onto you can replace the "catch all" 0.0.0.0 by your own IP. Notice this IP needs to be accessible from the telegraf plugin. You can use the option '-Dcom.sun.management.jmxremote.authenticate=false' if you don't want to authenticate. Use at your own risk.
----


== 物件與計數器

收集下列物件及其計數器：

[cols="<.<,<.<,<.<,<.<"]
|===
| 物件： | 識別碼： | 屬性： | 資料點： 


| Hadoop次要NameNode | 叢集
命名空間
伺服器 | 節點名稱
節點 IP
編譯資訊
版本 | GC 計數
GC 複本計數
GC Marks Sweep Compact Count
超過 GC 號碼資訊臨界值
超過 GC 號碼警告臨界值
GC 時間
GC 複製時間
GC Marks 掃出時間過短
GC 總額外睡眠時間
記錄錯誤計數
記錄致命計數
記錄資訊計數
記錄警告計數
已認可記憶體堆積
記憶體堆積上限
使用的記憶體堆積
記憶體最大
記憶體非堆積已認可
記憶體非堆積上限
未使用記憶體堆積
執行緒已封鎖
全新執行緒
執行緒 Runnable
執行緒已終止
執行緒逾時等待
等待的執行緒 


| Hadoop NodeManager | 叢集
命名空間
伺服器 | 節點名稱
節點 IP | 已分配的容器
記憶體分配
已分配的記憶體 Oportunic
虛擬核心已配置的開放式
已分配的虛擬核心
可用記憶體
可用的虛擬核心
目錄錯誤的本機
目錄不良記錄
清除前的快取大小
容器啟動持續時間平均時間
Container Launch Duration 營運次數
容器已完成
容器失敗
容器咬合
容器已遭殺害
已啟動的容器
容器重新輸入
容器在故障時回溯
執行中的容器
磁碟使用率良好的本機目錄
磁碟使用率良好記錄目錄
已刪除位元組私人
已刪除位元組公開
執行投機的容器
刪除的位元組總數
隨機播放連線
隨機播放輸出位元組
隨機輸出失敗
隨機輸出正常
GC 計數
GC 複本計數
GC Marks Sweep Compact Count
超過 GC 號碼資訊臨界值
超過 GC 號碼警告臨界值
GC 時間
GC 複製時間
GC Marks 掃出時間過短
GC 總額外睡眠時間
記錄錯誤計數
記錄致命計數
記錄資訊計數
記錄警告計數
已認可記憶體堆積
記憶體堆積上限
使用的記憶體堆積
記憶體最大
記憶體非堆積已認可
記憶體非堆積上限
未使用記憶體堆積
執行緒已封鎖
全新執行緒
執行緒 Runnable
執行緒已終止
執行緒逾時等待
等待的執行緒 


| Hadoop資源管理程式 | 叢集
命名空間
伺服器 | 節點名稱
節點 IP | ApplicationMaster 啟動延遲平均
ApplicationMaster 啟動延遲編號
ApplicationMaster 註冊延遲平均
ApplicationMaster 註冊延遲編號
NodeManager 作用中號碼
NodeManager 取消編號
NodeManager 取消編號
NodeManager 遺失編號
NodeManager 重新啟動的編號
NodeManager 關機編號
NodeManager 健全狀況編號
NodeManager 記憶體限制
NodeManager 虛擬核心限制
已用容量
作用中應用程式
作用中使用者
已分配的 Aggregate Container
已搶佔 Aggregate Container
已發行 Aggregate Container
已搶佔 Aggregate Memory 秒數
已分配的 Aggregate Node 本機容器
已配置的 Aggregate off 交換器容器
已分配 Aggregate Ack 本機容器
集合式虛擬核心數秒預先搶佔
已分配的容器
已分配的記憶體
已分配的虛擬核心
應用程式第一次嘗試 Container 分配延遲平均時間
應用程式嘗試第一個 Container Allocation Delay Number
應用程式已完成
應用程式失敗
應用程式遭殺害
應用程式擱置中
執行中的應用程式
已提交申請
可用記憶體
可用的虛擬核心
容器擱置中
記憶體擱置中
虛擬核心擱置中
保留的容器
保留的記憶體
保留虛擬核心
已使用記憶體 ApplicationMaster
使用的虛擬核心 ApplicationMaster
已使用容量
GC 計數
GC 複本計數
GC Marks Sweep Compact Count
超過 GC 號碼資訊臨界值
超過 GC 號碼警告臨界值
GC 時間
GC 複製時間
GC Marks 掃出時間過短
GC 總額外睡眠時間
記錄錯誤計數
記錄致命計數
記錄資訊計數
記錄警告計數
已認可記憶體堆積
記憶體堆積上限
使用的記憶體堆積
記憶體最大
記憶體非堆積已認可
記憶體非堆積上限
未使用記憶體堆積
執行緒已封鎖
全新執行緒
執行緒 Runnable
執行緒已終止
執行緒逾時等待
等待的執行緒 


| Hadoop DataNode | 叢集
命名空間
伺服器 | 節點名稱
節點 IP
叢集 ID
版本 | 收發器計數
傳輸進行中
快取容量
已使用快取
容量
使用的 DFS
預估容量損失總計
上次 Volume 失敗率
區塊編號快取
區塊編號無法快取
區塊編號無法取消快取
Volume 編號失敗
剩餘容量
GC 計數
GC 複本計數
GC Marks Sweep Compact Count
超過 GC 號碼資訊臨界值
超過 GC 號碼警告臨界值
GC 時間
GC 複製時間
GC Marks 掃出時間過短
GC 總額外睡眠時間
記錄錯誤計數
記錄致命計數
記錄資訊計數
記錄警告計數
已認可記憶體堆積
記憶體堆積上限
使用的記憶體堆積
記憶體最大
記憶體非堆積已認可
記憶體非堆積上限
未使用記憶體堆積
執行緒已封鎖
全新執行緒
執行緒 Runnable
執行緒已終止
執行緒逾時等待
等待的執行緒 


| Hadoop NameNode | 叢集
命名空間
伺服器 | 節點名稱
節點 IP
交易 ID 上次寫入
上次載入編輯後的時間
HA 狀態
檔案系統狀態
區塊集區 ID
叢集 ID
編譯資訊
明確版本計數
版本 | 區塊容量
區塊總數
容量總計
已使用容量
使用容量非 DFS
區塊毀損
預估容量損失總計
封鎖過多的資料
心跳已過期
檔案總數
檔案系統鎖定佇列長度
區塊遺失
利用第一因素封鎖遺失的複寫
用戶端作用中
資料節點停用
資料節點解除張力已停用
資料節點解除運作中的資料
資料節點取消配置
加密區域編號
資料節點進入維護
檔案正在建置中
資料節點在維護中停用
Data Node Live In Maintenance
資料節點即時運作
儲存過時
複寫擱置逾時
資料節點訊息擱置中
區塊擱置刪除
區塊擱置中的複寫
區塊複寫錯誤延遲
封鎖排程複寫
快照
Snapshottable 目錄
資料節點過時
檔案總數
總負載
同步計數總計
自上次檢查點以來的交易
自上次記錄檔記錄以來的交易
區塊不足複寫
磁碟區故障總計
同步時間總計
物件上限
作業區塊新增
作業允許快照
作業區塊批處理
作業區塊已排入佇列
作業區塊已接收及刪除
作業報告平均時間
營運封鎖報告編號
快取報告平均時間
快取報告編號
作業建立檔案
作業建立即時資料
Operations 建立 symlink
作業刪除檔案
作業刪除 Snapshot
作業不允許 Snapshot
作業檔案輸入 / 輸出
附加檔案
檔案已建立
檔案已刪除
檔案清單
檔案已重新命名
檔案遭截斷
檔案系統載入時間
作業產生 EDEK 平均時間
營運部門產生 EDEK
作業取得額外的資料節點
區塊會取得位置
取得編輯平均時間
取得編輯編號
取得影像平均時間
取得影像編號
作業取得連結目標
營運取得清單
Operations List Snapshottable 目錄
複寫非排程號碼
將影像平均時間
放置影像編號
作業重新命名即時資料
資源檢查時間平均時間
資源檢查時間號碼
安全模式時間
作業 Snapshot 差異報告
營運儲存區塊報告
複寫成功
同步平均時間
Operations Sync 編號
複寫逾時
營運總計
交易平均時間
交易 Batchd 同步
交易編號
EDEK WAMEUP 時間平均
EDEK Warmup 號碼
區塊集區已用空間
快取容量
已使用快取
可用容量
使用的區塊集區百分比
剩餘百分比
使用百分比
執行緒
GC 計數
GC 複本計數
GC Marks Sweep Compact Count
超過 GC 號碼資訊臨界值
超過 GC 號碼警告臨界值
GC 時間
GC 複製時間
GC Marks 掃出時間過短
GC 總額外睡眠時間
記錄錯誤計數
記錄致命計數
記錄資訊計數
記錄警告計數
已認可記憶體堆積
記憶體堆積上限
使用的記憶體堆積
記憶體最大
記憶體非堆積已認可
記憶體非堆積上限
未使用記憶體堆積
執行緒已封鎖
全新執行緒
執行緒 Runnable
執行緒已終止
執行緒逾時等待
等待的執行緒 


| Hadoop作業歷史伺服器 | 叢集
命名空間
伺服器 | 節點名稱
節點 IP | GC 計數
GC 複本計數
GC Marks Sweep Compact Count
超過 GC 號碼資訊臨界值
超過 GC 號碼警告臨界值
GC 時間
GC 複製時間
GC Marks 掃出時間過短
GC 總額外睡眠時間
記錄錯誤計數
記錄致命計數
記錄資訊計數
記錄警告計數
已認可記憶體堆積
記憶體堆積上限
使用的記憶體堆積
記憶體最大
記憶體非堆積已認可
記憶體非堆積上限
未使用記憶體堆積
執行緒已封鎖
全新執行緒
執行緒 Runnable
執行緒已終止
執行緒逾時等待
等待的執行緒 
|===


== 疑難排解

如需其他資訊、請參閱 link:concept_requesting_support.html["支援"] 頁面。
